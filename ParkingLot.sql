CREATE DATABASE ParkingLot

USE ParkingLot

CREATE TABLE VehicleTypes (
	VehicleTypeID	int IDENTITY (1, 1) PRIMARY KEY,
	VehicleTypeName nvarchar(MAX) not null,
	ParkingFee		int not null
);

CREATE TABLE Vehicles (
	VehicleID			int IDENTITY (1, 1) PRIMARY KEY,
	VehicleTypeID		int not null,
	ParkingCardID		bigint not null,
	TimeStartedParking	datetime2 not null, 
	TimeEndedParking	datetime2,
	VehicleState		int not null, -- 1: Parked, 0: Unparked --
	VehicleImage		nvarchar(max) not null, -- the path to the vehicle's image --
	Fee					int not null,
	StaffID				int not null
);

CREATE TABLE ParkingCards (
	ParkingCardID	bigint PRIMARY KEY,
	CardType		int not null, -- 0: Vang lai, 1: Thang
	CardState		int not null -- 1: Used, 0: Unused --
);

CREATE TABLE Accounts (
	AccountID		int IDENTITY (1, 1) PRIMARY KEY,
	StaffID			int not null,
	AccountName		nvarchar(MAX) not null,
	AccountPassword nvarchar(MAX) not null,
)

CREATE TABLE Roles (
	RoleID		int IDENTITY (1, 1) PRIMARY KEY,  -- 1: staff, 2: admin --
	RoleName	nvarchar(MAX) not null
);

CREATE TABLE Staff (
	StaffID			int IDENTITY (1, 1) PRIMARY KEY,
	CivilID			nvarchar(MAX) not null,
	StaffName		nvarchar(MAX) not null,
	RoleID			int not null,
	PhoneNumber		nvarchar(MAX),
	StaffAddress	nvarchar(MAX),
	DateOfBirth		date,
	IsDeleted		bit default 0 not null, -- 0: false, 1: true -- 
);

CREATE TABLE Timekeeps (
	TimekeepID int IDENTITY (1, 1) PRIMARY KEY,
	StaffID int not null,
	LoginTime datetime2 not null,
	LogoutTime datetime2
);

SET DATEFORMAT dmy;
--ALTER TABLE
ALTER TABLE Vehicles ADD CONSTRAINT Vehicles_VehicleTypeID_FK FOREIGN KEY (VehicleTypeID) REFERENCES VehicleTypes(VehicleTypeID);
ALTER TABLE Vehicles ADD CONSTRAINT Vehicles_StaffID_FK FOREIGN KEY (StaffID) REFERENCES Staff(StaffID);
ALTER TABLE Timekeeps ADD CONSTRAINT Timekeeps_StaffID_FK FOREIGN KEY (StaffID) REFERENCES Staff(StaffID) ON DELETE CASCADE;
ALTER TABLE Accounts ADD CONSTRAINT Accounts_StaffID_FK FOREIGN KEY (StaffID) REFERENCES Staff(StaffID) ON DELETE CASCADE;

ALTER TABLE Staff ADD CONSTRAINT Staff_RoleID_FK FOREIGN KEY (RoleID) REFERENCES Roles(RoleID);

--INSERT INTO
INSERT INTO Roles VALUES ('staff'), ('admin')

INSERT INTO VehicleTypes (VehicleTypeName, ParkingFee) VALUES (N'Xe máy', 4000), (N'Xe hơi', 8000), (N'Xe đạp', 1000)

INSERT INTO Staff (CivilID, StaffName, RoleID, PhoneNumber, StaffAddress, DateOfBirth) VALUES
('079202002040', 'admin', 2, '0912378784', '221 Baker St', '1/1/1990'),
('079202005979', 'Chatte', 1, '0945655469', '1 Holmes St', '28/12/2002'),
('079202035060', 'StarGazer', 2, '0939843426', '3 Sherlock St', '22/6/2002'),
('079202003950', 'Dragon', 1, '0868410903', '5 Watson St', '20/9/2002'),
('079202034050', 'MiMi', 2, '0916056982', '7 London St', '8/6/2002')

INSERT INTO Accounts (StaffID, AccountName, AccountPassword) VALUES
(1, 'admin', '8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918'),
(2, '1', '6b86b273ff34fce19d6b804eff5a3f5747ada4eaa22f1d49c01e52ddb7875b4b'),
(3, '2', 'd4735e3a265e16eee03f59718b9b5d03019c07d8b6c51f90da3a666eec13ab35'),
(4, '3', '4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce'),
(5, '4', '94938b8212580c530e8b2a863f2e5b03fa3b060421e752eb2a0c6941250ecaa0')

INSERT INTO Timekeeps (StaffID, LoginTime, LogoutTime) VALUES
( 1, '2023-06-09 00:07:01.7291212','2023-06-09 00:07:16.2086860'),
( 1, '2023-06-09 00:07:19.5876126','2023-06-09 00:08:06.8272546'),
( 2, '2023-06-09 00:07:19.5876126','2023-06-09 00:08:31.6599561'),
( 1, '2023-06-09 00:38:22.4294729','2023-06-09 00:38:27.9693305'),
( 2, '0001-01-01 00:00:00.0000000','2023-06-09 00:41:18.5418983'),
( 1, '2023-06-09 00:41:21.7622679','2023-06-09 00:41:28.3411406'),
( 1, '2023-06-09 00:45:49.1628018','2023-06-09 00:45:56.7665148'),
( 2, '2023-06-09 00:45:49.1628018','2023-06-09 00:46:11.4326709'),
( 1, '2023-06-09 00:48:15.5542902','2023-06-09 00:48:40.0033276'),
( 1, '2023-06-09 00:48:58.9506476','2023-06-09 00:51:48.7217780'),
( 3, '2023-06-09 00:51:51.7214336','2023-06-09 00:53:14.8826361')

INSERT INTO ParkingCards (ParkingCardID, CardType, CardState) VALUES
(1111111111,0,0),
(2222222222,0,0),
(3333333333,0,0),
(4444444444,0,0),
(5555555555,0,0)

INSERT INTO Vehicles (VehicleTypeID, ParkingCardID, TimeStartedParking, TimeEndedParking, VehicleState, VehicleImage, Fee, StaffID) VALUES

------------2023
-------T1
--Xe may
(1, 1111111111, '2023-01-09 09:52:02.2333014','2023-01-09 09:52:03.9253225' ,0,'DA09_01_2023 09_52_02 SA.jpg',4000,4),
(1, 1111111111, '2023-01-09 09:52:05.6048091','2023-01-09 09:52:07.2583889' ,0,'DA09_01_2023 09_52_05 SA.jpg',4000,4),
(1, 3333333333, '2023-01-09 09:52:08.7418370','2023-01-09 09:52:10.2789797' ,0,'DA09_01_2023 09_52_08 SA.jpg',4000,4), 
(1, 4444444444, '2023-01-09 09:52:11.8680257','2023-01-09 09:52:13.2552277' ,0,'DA09_01_2023 09_52_11 SA.jpg',4000,4),

--Xe hoi
(2, 2222222222, '2023-01-09 09:52:17.3936920','2023-01-09 09:52:18.7378777' ,0,'DA09_01_2023 09_52_17 SA.jpg',8000,4),

--Xe dap
(3, 3333333333, '2023-01-09 09:52:22.4438017','2023-01-09 09:52:23.7172858' ,0,'DA09_01_2023 09_52_22 SA.jpg',1000,4),

-------T2
--Xe may
(1, 1111111111, '2023-02-09 09:52:35.8706115','2023-02-09 09:52:41.8534150' ,0,'DA09_02_2023 09_52_35 SA.jpg',4000,4),
(1, 2222222222, '2023-02-09 09:52:37.5068747','2023-02-09 09:52:43.7163362' ,0,'DA09_02_2023 09_52_37 SA.jpg',4000,4),
(1, 3333333333, '2023-02-09 09:52:38.9975144','2023-02-09 09:52:45.1922423' ,0,'DA09_02_2023 09_52_38 SA.jpg',4000,4), 
(1, 4444444444, '2023-02-09 09:52:40.3409808','2023-02-09 09:52:46.5919968' ,0,'DA09_02_2023 09_52_40 SA.jpg',4000,4),

--Xe hoi
(2, 2222222222, '2023-02-09 09:52:49.5468274','2023-02-09 09:52:51.5533768' ,0,'DA09_02_2023 09_52_49 SA.jpg',8000,4),
(2, 3333333333, '2023-02-09 09:52:53.0884946','2023-02-09 09:52:54.4144475' ,0,'DA09_02_2023 09_52_53 SA.jpg',8000,4),
(2, 4444444444, '2023-02-09 09:52:55.8086058','2023-02-09 09:52:57.4003549' ,0,'DA09_02_2023 09_52_55 SA.jpg',8000,4),
(2, 1111111111, '2023-02-09 09:53:03.0146125','2023-02-09 09:53:04.3860604' ,0,'DA09_02_2023 09_53_03 SA.jpg',8000,4),
(2, 4444444444, '2023-02-09 09:53:06.7412989','2023-02-09 09:53:08.1051097' ,0,'DA09_02_2023 09_53_06 SA.jpg',8000,4),
(2, 1111111111, '2023-02-09 09:53:09.9295015','2023-02-09 09:53:11.4097742' ,0,'DA09_02_2023 09_53_09 SA.jpg',8000,4),
(2, 4444444444, '2023-02-09 09:53:13.7425516','2023-02-09 09:53:15.3751453' ,0,'DA09_02_2023 09_53_13 SA.jpg',8000,4),

--Xe dap
(3, 4444444444, '2023-02-09 09:53:22.3865078','2023-02-09 09:53:23.6635317' ,0,'DA09_02_2023 09_53_22 SA.jpg',1000,4),
(3, 2222222222, '2023-02-09 09:53:25.3141914','2023-02-09 09:53:26.5856777' ,0,'DA09_02_2023 09_53_25 SA.jpg',1000,4),

-------T3
--Xe may
(1, 1111111111, '2023-03-09 09:53:43.4320271','2023-03-09 09:53:50.1004292' ,0,'DA09_03_2023 09_53_43 SA.jpg',4000,4), 
(1, 2222222222, '2023-03-09 09:53:45.7624476','2023-03-09 09:53:51.4757734' ,0,'DA09_03_2023 09_53_45 SA.jpg',4000,4),
(1, 3333333333, '2023-03-09 09:53:47.1224925','2023-03-09 09:53:52.8323001' ,0,'DA09_03_2023 09_53_47 SA.jpg',4000,4),
(1, 4444444444, '2023-03-09 09:53:48.7222687','2023-03-09 09:53:54.1818467' ,0,'DA09_03_2023 09_53_48 SA.jpg',4000,4),
(1, 2222222222, '2023-03-09 09:53:57.0987076','2023-03-09 09:53:58.5921054' ,0,'DA09_03_2023 09_53_57 SA.jpg',4000,4),
(1, 3333333333, '2023-03-09 09:54:00.3453902','2023-03-09 09:54:01.5490530' ,0,'DA09_03_2023 09_54_00 SA.jpg',4000,4),
(1, 4444444444, '2023-03-09 09:54:03.2610058','2023-03-09 09:54:08.0270455' ,0,'DA09_03_2023 09_54_03 SA.jpg',4000,4),
(1, 1111111111, '2023-03-09 09:54:09.8445578','2023-03-09 09:54:11.5629128' ,0,'DA09_03_2023 09_54_09 SA.jpg',4000,4),
(1, 2222222222, '2023-03-09 09:54:13.2499741','2023-03-09 09:54:14.6540974' ,0,'DA09_03_2023 09_54_13 SA.jpg',4000,4),

--Xe hoi
(2, 3333333333, '2023-03-09 09:54:19.8190246','2023-03-09 09:54:21.2456115' ,0,'DA09_03_2023 09_54_19 SA.jpg',8000,4),
(2, 4444444444, '2023-03-09 09:54:22.8391024','2023-03-09 09:54:24.1582912' ,0,'DA09_03_2023 09_54_22 SA.jpg',8000,4),

--Xe dap
(3, 2222222222, '2023-03-09 09:54:29.5899879','2023-03-09 09:54:30.9117966' ,0,'DA09_03_2023 09_54_29 SA.jpg',1000,4),
(3, 3333333333, '2023-03-09 09:54:32.3602646','2023-03-09 09:54:33.5800185' ,0,'DA09_03_2023 09_54_32 SA.jpg',1000,4),
(3, 1111111111, '2023-03-09 09:56:01.2879504','2023-03-09 09:56:02.7004999' ,0,'DA09_03_2023 09_56_01 SA.jpg',1000,4), 
(3, 3333333333, '2023-03-09 09:56:05.6502559','2023-03-09 09:56:06.9873154' ,0,'DA09_03_2023 09_56_05 SA.jpg',1000,4),
(3, 2222222222, '2023-03-09 09:56:08.3527437','2023-03-09 09:56:09.6748960' ,0,'DA09_03_2023 09_56_08 SA.jpg',1000,4),
(3, 4444444444, '2023-03-09 09:56:11.3202513','2023-03-09 09:56:12.8992759' ,0,'DA09_03_2023 09_56_11 SA.jpg',1000,4),
(3, 2222222222, '2023-03-09 09:56:14.3646041','2023-03-09 09:56:15.6835339' ,0,'DA09_03_2023 09_56_14 SA.jpg',1000,4),
(3, 1111111111, '2023-03-09 09:56:17.2999018','2023-03-09 09:56:18.5148248' ,0,'DA09_03_2023 09_56_17 SA.jpg',1000,4),

-------T4
--Xe may
(1, 1111111111, '2023-04-09 09:40:36.6068496','2023-04-09 09:40:40.0442438' ,0,'DA09_04_2023 09_40_36 SA.jpg',4000,4),
(1, 4444444444, '2023-04-09 09:40:51.8434844','2023-04-09 09:40:53.1979852' ,0,'DA09_04_2023 09_40_51 SA.jpg',4000,4),

--Xe hoi
(2, 3333333333, '2023-04-09 09:40:42.9274154','2023-04-09 09:40:44.4231945' ,0,'DA09_04_2023 09_40_42 SA.jpg',8000,4),
(2, 2222222222, '2023-04-09 09:57:12.3346050','2023-04-09 09:57:13.7648369' ,0,'DA09_04_2023 09_57_12 SA.jpg',8000,4),
(2, 3333333333, '2023-04-09 09:57:15.1099647','2023-04-09 09:57:16.3512931' ,0,'DA09_04_2023 09_57_15 SA.jpg',8000,4), 
(2, 1111111111, '2023-04-09 09:57:17.7236453','2023-04-09 09:57:19.1387963' ,0,'DA09_04_2023 09_57_17 SA.jpg',8000,4),
(2, 4444444444, '2023-04-09 09:57:20.9307041','2023-04-09 09:57:22.1023973' ,0,'DA09_04_2023 09_57_20 SA.jpg',8000,4),
(2, 2222222222, '2023-04-09 09:57:23.7551414','2023-04-09 09:57:25.0132777' ,0,'DA09_04_2023 09_57_23 SA.jpg',8000,4),
(2, 1111111111, '2023-04-09 09:57:26.6073031','2023-04-09 09:57:27.8918394' ,0,'DA09_04_2023 09_57_26 SA.jpg',8000,4),

--Xe dap
(3, 1111111111, '2023-04-09 09:40:31.9332566','2023-04-09 09:40:33.3930831' ,0,'DA09_04_2023 09_40_31 SA.jpg',1000,4), 
(3, 2222222222, '2023-04-09 09:40:47.3049321','2023-04-09 09:40:48.8446298' ,0,'DA09_04_2023 09_40_47 SA.jpg',1000,4),
(3, 1111111111, '2023-04-09 09:56:59.5336116','2023-04-09 09:57:00.8728859' ,0,'DA09_04_2023 09_56_59 SA.jpg',1000,4),

-------T5
--Xe may
(1, 4444444444, '2023-05-09 09:39:34.2234272','2023-05-09 09:39:37.2697368' ,0,'DA09_05_2023 09_39_34 SA.jpg',4000,4), 
(1, 1111111111, '2023-05-09 09:39:50.6099020','2023-05-09 09:39:52.2747823' ,0,'DA09_05_2023 09_39_50 SA.jpg',4000,4),
(1, 1111111111, '2023-05-09 09:40:00.3480454','2023-05-09 09:40:01.7174507' ,0,'DA09_05_2023 09_40_00 SA.jpg',4000,4),

--Xe hoi
(2, 1111111111, '2023-05-09 09:39:41.2479181','2023-05-09 09:39:42.9472394' ,0,'DA09_05_2023 09_39_41 SA.jpg',8000,4),
(2, 2222222222, '2023-05-09 09:58:09.6032833','2023-05-09 09:58:12.0507194' ,0,'DA09_05_2023 09_58_09 SA.jpg',8000,4),
(2, 3333333333, '2023-05-09 09:58:20.5276966','2023-05-09 09:58:21.8509882' ,0,'DA09_05_2023 09_58_20 SA.jpg',8000,4),
(2, 1111111111, '2023-05-09 10:02:01.7376345','2023-05-09 10:02:07.7212746' ,0,'DA09_05_2023 10_02_01 SA.jpg',8000,4),
(2, 2222222222, '2023-05-09 10:02:03.5479778','2023-05-09 10:02:08.9354752' ,0,'DA09_05_2023 10_02_03 SA.jpg',8000,4),
(2, 3333333333, '2023-05-09 10:02:04.9176619','2023-05-09 10:02:10.2315501' ,0,'DA09_05_2023 10_02_04 SA.jpg',8000,4),
(2, 4444444444, '2023-05-09 10:02:06.3105629','2023-05-09 10:02:11.5438316' ,0,'DA09_05_2023 10_02_06 SA.jpg',8000,4),
(2, 1111111111, '2023-05-09 10:02:14.8086330','2023-05-09 10:02:16.1981017' ,0,'DA09_05_2023 10_02_14 SA.jpg',8000,4),
(2, 2222222222, '2023-05-09 10:02:17.7530117','2023-05-09 10:02:18.9603064' ,0,'DA09_05_2023 10_02_17 SA.jpg',8000,4),

--Xe dap
(3, 2222222222, '2023-05-09 09:39:45.9116651','2023-05-09 09:39:47.4365872' ,0,'DA09_05_2023 09_39_45 SA.jpg',1000,4),
(3, 4444444444, '2023-05-09 09:39:56.3687651','2023-05-09 09:39:57.8319295' ,0,'DA09_05_2023 09_39_56 SA.jpg',1000,4),
(3, 1111111111, '2023-05-09 10:02:24.7766652','2023-05-09 10:02:30.4247976' ,0,'DA09_05_2023 10_02_24 SA.jpg',1000,4),
(3, 2222222222, '2023-05-09 10:02:26.4791325','2023-05-09 10:02:31.7126413' ,0,'DA09_05_2023 10_02_26 SA.jpg',1000,4),
(3, 3333333333, '2023-05-09 10:02:27.7639599','2023-05-09 10:02:32.9499973' ,0,'DA09_05_2023 10_02_27 SA.jpg',1000,4),
(3, 4444444444, '2023-05-09 10:02:29.1040389','2023-05-09 10:02:34.1930562' ,0,'DA09_05_2023 10_02_29 SA.jpg',1000,4),
(3, 1111111111, '2023-05-09 10:02:36.0483796','2023-05-09 10:02:37.2237570' ,0,'DA09_05_2023 10_02_36 SA.jpg',1000,4),


-------T6
--Xe may
(1, 1111111111, '2023-06-09 09:34:05.1775513', '2023-06-09 09:34:09.1886115',0,'DA09_06_2023 09_34_05 SA.jpg',4000,2),
(1, 1111111111, '2023-06-09 09:35:09.1934355','2023-06-09 09:36:23.2478671' ,0,'DA09_06_2023 09_35_09 SA.jpg',4000,4),
(1, 1111111111, '2023-06-09 09:38:13.3122163','2023-06-09 09:38:33.2918867' ,0,'DA09_06_2023 09_38_13 SA.jpg',4000,4),
(1, 4444444444, '2023-06-09 09:38:55.0612944','2023-06-09 09:38:56.7990368' ,0,'DA09_06_2023 09_38_55 SA.jpg',4000,4),
(1, 2222222222, '2023-06-09 09:38:59.1741603','2023-06-09 09:39:00.7858067' ,0,'DA09_06_2023 09_38_59 SA.jpg',4000,4),
(1, 1111111111, '2023-06-09 10:05:10.2186536','2023-06-09 10:05:14.2097796' ,0,'DA09_06_2023 10_05_10 SA.jpg',4000,4),
(1, 2222222222, '2023-06-09 10:05:11.6018266','2023-06-09 10:05:15.6121457' ,0,'DA09_06_2023 10_05_11 SA.jpg',4000,4),
(1, 3333333333, '2023-06-09 10:05:12.8683071','2023-06-09 10:05:17.1954792' ,0,'DA09_06_2023 10_05_12 SA.jpg',4000,4),

--Xe hoi
(2, 2222222222, '2023-06-09 09:38:17.9803616','2023-06-09 09:38:31.5951799' ,0,'DA09_06_2023 09_38_17 SA.jpg',8000,4),
(2, 3333333333, '2023-06-09 09:38:39.8700359','2023-06-09 09:38:41.7155717' ,0,'DA09_06_2023 09_38_39 SA.jpg',8000,4),

--Xe dap
(3, 3333333333, '2023-06-09 09:38:20.4980969','2023-06-09 09:38:29.9510577' ,0,'DA09_06_2023 09_38_20 SA.jpg',1000,4),
(3, 4444444444, '2023-06-09 09:38:23.9522534','2023-06-09 09:38:27.4373934' ,0,'DA09_06_2023 09_38_23 SA.jpg',1000,4),
(3, 1111111111, '2023-06-09 09:38:46.3238577','2023-06-09 09:38:47.9089199' ,0,'DA09_06_2023 09_38_46 SA.jpg',1000,4),
(3, 1111111111, '2023-06-09 10:05:21.7468003','2023-06-09 10:05:26.9706576' ,0,'DA09_06_2023 10_05_21 SA.jpg',1000,4),
(3, 2222222222, '2023-06-09 10:05:22.9978756','2023-06-09 10:05:28.1288684' ,0,'DA09_06_2023 10_05_22 SA.jpg',1000,4),
(3, 3333333333, '2023-06-09 10:05:24.2782480','2023-06-09 10:05:29.2476237' ,0,'DA09_06_2023 10_05_24 SA.jpg',1000,4),
(3, 4444444444, '2023-06-09 10:05:25.4420597','2023-06-09 10:05:30.4109600' ,0,'DA09_06_2023 10_05_25 SA.jpg',1000,4),
(3, 1111111111, '2023-06-09 10:05:32.5721642','2023-06-09 10:05:36.2124066' ,0,'DA09_06_2023 10_05_32 SA.jpg',1000,4),
(3, 2222222222, '2023-06-09 10:05:34.3070367','2023-06-09 10:05:38.2133164' ,0,'DA09_06_2023 10_05_34 SA.jpg',1000,4)
